#define n BOOST_PP_ITERATION()

template<
		GENERICHANDLER_RETURN_CLASS
		class T BOOST_PP_COMMA_IF(n) 
		BOOST_PP_ENUM_PARAMS(n,class P)
>
class GENERICHANDLER_CLASS_NAME<
			GENERICHANDLER_RETURN_TYPE,
			T BOOST_PP_COMMA_IF(n) 
			BOOST_PP_ENUM_PARAMS(n,P)
			> 
	: public MsgMapHandlerImpl<T>
{
public:

	typedef GENERICHANDLER_RETURN_TYPE ( GENERICHANDLER_CALL_TYPE T::*Fun)(BOOST_PP_ENUM_PARAMS(n,P));

	GENERICHANDLER_CLASS_NAME( Fun ptr BOOST_PP_COMMA_IF(n) BOOST_PP_ENUM_BINARY_PARAMS(n,P,p) )
		:func(ptr) BOOST_PP_COMMA_IF(n) BOOST_PP_REPEAT(n,GENERIC_PARAM,~)
	{}

	LRESULT operator()( mol::win::WndProc* This, UINT msg, WPARAM wParam, LPARAM lParam)
	{
		T* object = (T*)This;
		GENERICHANDLER_RETURN_DECL ((object->*func)( BOOST_PP_ENUM_PARAMS(n,Param) ));
		GENERICHANDLER_BASE_CALL;
		GENERICHANDLER_RETURN_POLICY;
	}

	BOOST_PP_REPEAT(n,GENERIC_PARAM_DECL,~)

	Fun				func;
};


#undef n

