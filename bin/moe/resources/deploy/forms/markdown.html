<html>

<head>
  <script> 
  // legacy IE polyfill to make shutdown.js work
if (!Array.isArray) {
  Array.isArray = function(arg) {
    return Object.prototype.toString.call(arg) === '[object Array]';
  };
}
  </script>
  <script src="../js/showdown.js"></script>
</head>

<body>

<div id="markdown"></div>

<script> 

var txt = "";

var markdown;//  = document.getElementById("markdown");
var converter;// = new showdown.Converter();

var active;// = window.chrome.webview.hostObjects.sync.Controller.getActive();
//alert(active);
function update()
{
	active = window.chrome.webview.hostObjects.sync.Controller.getActive();
	console.log(active);

try {
	var tmp = active.Model.Text.GetText();
	if(tmp != txt) 
	{
		txt = tmp;
		var html = converter.makeHtml(txt);
		markdown.innerHTML = html;
	}
}
catch(e) {
}
	setTimeout( update, 1000 );
}


setTimeout(function() {

	markdown  = document.getElementById("markdown");
	converter = new showdown.Converter();

  //alert("onload");
//alert();
	//alert(active);

  update();
},500);

</script>

</body>
</html>
