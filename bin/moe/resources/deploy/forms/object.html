<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
 <head>
  <title>typelib viewer</title>
  <link rel="stylesheet" type="text/css" href="../css/doc.css" />
 </head>

 <body onload="init()">

 <form name="theForm" action="#"  method="GET">
  <select name="typelib">
   <option value="moe.exe">moe</option>
   <option value="ScintillAx.dll">ScintillAx</option>
   <option value="Shellctrl.dll">ShellControls</option>
   <option value="comtypes.dll">comtypes</option>
   <option value="io.dll">io</option>
   <option value="pipedprocess.dll">pipedprocess</option>
   <option value="setting.dll">settings</option>
   <option value="ssh.dll">ssh</option>
   <option value="jre.exe">jre</option>
<!--   <option value="net.exe">net</option> -->
   <option value="userforms.exe">userform</option>
  </select>
 </form>

 <div id="documentation" style="margin:10px"></div>

<script language="javascript">

//alert(window.location.hash+" : "+window.location.search);

var path;
var type2Xml = null;
var xslt;
var xsl;
var docu;


function loadDoc(file) 
{
	var xmlDoc =  window.chrome.webview.hostObjects.sync.external.Moe.Script.CreateObject("Msxml2.DOMDocument.3.0");
    xmlDoc.async = false;
    xmlDoc.load(file);
    return xmlDoc;
}

function init()
{
    document.theForm.typelib.onchange = function() {getDocu(this.value,""); };

	docu = document.getElementById("documentation");

	var object  = window.location.hash.substring(1);
	var typelib = window.location.search.substring(1).replace(/\//g,"\\");

	object 	= typelib != "" ? object  : "";
	typelib = typelib != "" ? typelib  : "moe.exe";
	typelib = typelib.replace(/%20/g," ");
	getDocu(typelib, object);
	return false;
}


function getDocu( typelib, param )
{
	xsl  = loadDoc("xsl\\doc.xsl");
//	path = window.chrome.webview.hostObjects.sync.external.Moe.Script.CreateObject("IO.Path");
	type2Xml = window.chrome.webview.hostObjects.sync.external.Moe.Script.CreateObject("TypeToXml.TypeLibToXml");

	if ( typelib != "" && xsl && type2Xml )
	{
	    docu.innerHTML = "<img src='../img/wait.gif' />";
		type2Xml.Load(typelib);
        var r = type2Xml.transform(xsl);
		docu.innerHTML = r;//window.type2Xml.Result;
	}
}	


</script>

 </body>
 
</html>
