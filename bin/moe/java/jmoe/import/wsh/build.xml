<?xml version="1.0" encoding="UTF-8"?>

<!--
builds mshtml wrappers
-->

<project name="wsh" default="wsh" basedir=".">

 <target name="clean" description="Cleanup">
 	<echo>cleaning up ...</echo>
 	<delete dir="." includes="**\*.java"/>
 	<delete dir="." includes="**\*.class"/>
	<delete dir="." includes="mol.wsh.jar"/>
 </target>	

 <target name="import" description="importing mshtml tlb" depends="clean">
 	<echo>importing ...</echo>  	
 	<java jar="../../com4j/build/dist/tlbimp.jar"
 		args="-o . -p mol.wsh C:\Windows\System32\wshom.ocx" fork="true"
 		newenvironment="true" maxmemory="2000000"
 	/> 	
 </target>	
	
 <target name="compile" description="Compiling ..." depends="import">
 	<echo>compiling ...</echo>  	
	<javac srcdir="." destdir="." classpath=".;..\..\com4j\build\dist\com4j.jar" />
 </target>	
	
 <target name="wsh" depends="compile">
  <jar jarfile="mol.wsh.jar" includes="**\*.class" basedir="." /> 
  <echo>done :-)</echo>  	

 </target>
</project> 
 