<mol:codegen class="MoeWndGUIBuilder" 
               xmlns="urn:mol-codegen" 
               xmlns:mol="urn:mol-codegen" 
               xmlns:xs="http://www.w3.org/2001/XMLSchema" 
			   xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
			   xsi:schemaLocation='urn:mol-codegen ..\..\..\cg\xml\resource.xsd'>
   
 
  <!-- main GUI description -->
 
  <ui >

    <!-- 
      define the main frame moe window 
      the window has a name, a type, a 'windows internal'
      a std menu and a borderlayout positioned to standard new window rect
      identified as midi mainframe by the midi attribute specifying the 
      mdi view menu.
      persistent state is loaded via generated command.
      drag drop is initalized to member "Drop" - accelerators are loaded
      the window is shown. due to attribute accessor set to "true", 
      simple accessors (global c-functions) are generated for moe and its
      static child windows
      
      accessor generates an global function name $name to accesss the widget moe()
      
      // persistStorage='appPath() + _T("\\ui.xmo")'   
    -->
    <window name="moe" class="MoeWnd" id="IDW_MOE" xmenu="IDM_SMALL_MENU"
            layout="BorderLayout" pos="stdRect" mdi="IDM_VIEW_WINDOWS"
            dragDrop='moe->moeDrop.get()' show='SW_SHOW' accel='IDA_MOE' accessor='true'>

      <!-- act as an ole container -->
      <!-- we provide these menues for menu merging with ole embedding -->
      <olemenu menu='IDM_MOE'>
        <file cmd='IDM_FILE'/>
        <window cmd='IDM_VIEW' />
      </olemenu>
      <!-- 
        we provide these target commands for ole embedding - so we tell an embedded
        object to (possibly!) forward these commands to us - mapping the call to
        the named cmd IF it occurs
      -->
      <olecmds>
        <olecmd cmd='IDM_FILE_NEW' oletarget='OLECMDID_NEW' />
        <olecmd cmd='IDM_FILE_OPEN' oletarget='OLECMDID_OPEN' />
        <olecmd cmd='IDM_FILE_SAVE' oletarget='OLECMDID_SAVE' />
        <olecmd cmd='IDM_FILE_SAVE_AS' oletarget='OLECMDID_SAVEAS' />
        <olecmd cmd='IDM_FILE_PRINT' oletarget='OLECMDID_PRINT' />
      </olecmds>

      <!-- the ribbon html view -->
      <window name="ribbon" id="ID_MOE_HTML_RIBBON" class="MoeHtmlRibbon" pos="mol::Rect(0,0,160,133)"
             visible="true" layout="BorderLayout::NORTH" />

      <!-- the directory tree view -->
      <window name="treeWnd" id="IDW_TREE_VIEW" class="MoeTreeWnd" pos="mol::Rect(0,0,160,200)"
             visible="true" layout="BorderLayout::WEST" advise="moe->treeSink"/>

      <!-- the child window selector tab control -->
      <window name="tab"  id="IDW_TAB_CTRL" class="MoeTabControl" pos="mol::Rect(0,0,160,26)" visible="false" layout="BorderLayout::SOUTH" >
      </window>


      <!-- application status bar -->
      <statusbar name="statusBar" id="IDW_STATUS" class="MoeStatusBar" pos="mol::stdRect" >
        <set member="Text">_T("")</set>
        <window name="progress" id="IDW_PROGRESS_BAR" class="mol::ProgressbarCtrl" pos="mol::Rect(3,7,300,12)"
               visible="true" >
          <set member="Color">RGB(175,175,175)</set>
          <set member="BkColor">RGB(222,222,222)</set>
          <set member="Range">0,100</set>
          <set member="Pos">10</set>
        </window>
      </statusbar>
    </window>
    <!-- ui helper singletons -->
    
    <!-- open document collection -->
    <singleton name="docs" class="Documents" />

    <singleton name="codePages" class="Encodings" />

    <!-- events -->
<!--
    <singleton name="treeWndSink" class="TreeWndSink" />
    <singleton name="moeDropTarget" class="MoeDrop" />
    -->

    <!-- dialogs -->
    <!--
    <singleton name="searchDlg" class="mol::SearchDlg" />
    
    <singleton name="urlDlg" class="UrlDlg" />
    -->
    <singleton name="debugDlg" class="DebugDlg" />

    <!-- COM singleton: user settings -->
    <!--
    <singleton name="config" class="ISetting" clsid="CLSID_Setting" />
    -->
    
    <!-- COM singleton: user styles -->
    <!--
    <singleton name="styles" class="IScintillAxStyleSets" clsid="CLSID_ScintillAxStyleSets" />    
    -->
    
    <!-- noncreatable COM singleton: scripting support -->
    <!--
    <singleton name="scriptlet" class="Script" interface="IActiveScriptSite" />
-->
    <!-- simple app setting singletons -->
    
    <!-- path to moe's user application setting directory -->
    <!--
    <singleton name="appPath" path='moe' />
    -->
    <!-- path to moe's user application setting persistent file -->
    <!--
    <singleton name="prefPath" string='appPath() + _T("\\xpref.xmo")' />
    -->
    <!-- path to moe executable -->
    <!--
    <singleton name="binPath" module='moe' />
    -->
  </ui>


</mol:codegen>

