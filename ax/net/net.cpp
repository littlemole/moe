#include "stdafx.h"
#include "netserver.h"
#include "net_i.c"


/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
// main entry point of moe app
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////

int APIENTRY _tWinMain(HINSTANCE hInstance,
                     HINSTANCE hPrevInstance,
                     LPTSTR    lpCmdLine,
                     int       nCmdShow)
{
	ODBGS("JRE startup");
	ODBGS(lpCmdLine);

	//::DebugBreak();
//	::MessageBoxA(0,"startup",".NET",0);

	::CoInitializeEx(0,COINIT_MULTITHREADED);

    try
    {
		{		
			mol::run<NetApp>(lpCmdLine);	
		}

    }
    catch (mol::X& x)
    {
        ::MessageBoxA(0,x.what(),"error",0);
        return 1;
    }
	::CoUninitialize();
    return 0;
}

/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////
/////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////





